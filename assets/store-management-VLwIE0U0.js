import{j as e,M as $,B as b,T as L,k as d,l as q,m as O,n as B,o as w,p as G,q as U,t as z,r as x,F,v as K,w as Y,E as Q,x as H,y as J,z as X,C as D}from"./index-XhOnHmxS.js";import{C as Z}from"./CustomTable-Dcw7gJub.js";import{B as y}from"./Button-DLuNJo-s.js";import{D as V}from"./delete-confirmation.modal-CiEb0n-T.js";import{M as ee}from"./MenuItem-BemfmAb7.js";function te({isOpen:i,handleCancel:c,formData:n,handleFormData:l,handleSubmit:C,isUpdate:I}){const m=q;return e.jsx($,{open:i,onClose:()=>c(),children:e.jsxs(b,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:5,borderRadius:2},children:[e.jsx(L,{variant:"H5",content:I?"UPDATE_PRODUCT":"ADD_PRODUCT"}),e.jsxs(b,{display:"flex",flexDirection:"column",className:"gap-5 mt-4",children:[e.jsx(d,{className:"w-full",label:m({content:"PRODUCT_NAME"}),name:"ProductName",value:n==null?void 0:n.ProductName,onChange:l,fullWidth:!0}),e.jsx(d,{label:m({content:"PRODUCT_DESCRIPTION"}),name:"Description",value:n==null?void 0:n.Description,onChange:l,fullWidth:!0,rows:2}),e.jsx(d,{label:m({content:"MAKING_COST"}),name:"MakingPrice",type:"number",value:n==null?void 0:n.MakingPrice,onChange:l,fullWidth:!0}),e.jsx(d,{label:m({content:"SELLING_COST"}),name:"SellingPrice",type:"number",value:n==null?void 0:n.SellingPrice,onChange:l,fullWidth:!0}),e.jsx(d,{label:m({content:"QUANTITY"}),name:"Quantity",type:"number",value:n==null?void 0:n.Quantity,onChange:l,fullWidth:!0})]}),e.jsxs(b,{display:"flex",justifyContent:"flex-end",className:"gap-4 mt-4",children:[e.jsx(y,{variant:"outlined",color:"secondary",onClick:()=>c(),children:"Cancel"}),e.jsx(y,{variant:"contained",color:"primary",onClick:()=>C(),children:I?"Update":"Save"})]})]})})}const ne=O({ProductionInfo:B().of(O({ProductId:G().required("Product ID is required"),CurrentQuantity:w().required("CurrentQuantity is required").positive("CurrentQuantity must be positive").integer("CurrentQuantity must be an integer"),ProductionAmount:w().required("ProductionAmount is required").positive("ProductionAmount must be positive").integer("ProductionAmount must be an integer")})).min(1,"At least one product is required")}),oe={ProductionInfo:[{ProductId:"",CurrentQuantity:0,ProductionAmount:0}]};function ie({isOpen:i,handleClose:c}){const{data:n,isLoading:l,refetch:C}=U({pageNumber:1,pageSize:1e3,itemId:""}),[I,{isLoading:m}]=z(),f=(n==null?void 0:n.Data)||[],A=async a=>{let r={ProductionInfo:[]};a.ProductionInfo.forEach(P=>{P.ProductId!==""&&r.ProductionInfo.push({ProductId:P.ProductId,Quantity:P.CurrentQuantity})}),console.log("Payload",r),await I({payload:r}).unwrap(),c()};return x.useEffect(()=>{C()},[C]),e.jsx($,{open:i,onClose:()=>c(),children:e.jsxs(b,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"50%",bgcolor:"background.paper",boxShadow:24,p:5,borderRadius:2},children:[e.jsx(L,{variant:"H5",content:"ADD_PRODUCTION"}),e.jsx(F,{initialValues:oe,validationSchema:ne,onSubmit:a=>{console.log("Form data",a)},children:({values:a,setFieldValue:r,errors:P,touched:N})=>{const j=a.ProductionInfo.map(p=>p.ProductId);return e.jsxs(K,{children:[e.jsx(Y,{name:"ProductionInfo",render:p=>e.jsxs("div",{children:[a.ProductionInfo.map((h,o)=>e.jsx("div",{className:"my-4",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{label:"Product ID",name:`ProductionInfo[${o}].ProductId`,fullWidth:!0,variant:"outlined",select:!0,value:h.ProductId,onChange:t=>{r(`ProductionInfo[${o}].ProductId`,t.target.value);const u=f.find(g=>g.ItemId===t.target.value);r(`ProductionInfo[${o}].CurrentQuantity`,(u==null?void 0:u.Quantity)||0)},children:f.map(t=>e.jsx(ee,{disabled:j.indexOf(t.ItemId)>-1,value:t.ItemId,children:t.ProductName},t.ItemId))}),e.jsx(Q,{name:`ProductionInfo[${o}].ProductId`,component:"div",className:"text-red-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{disabled:!0,label:"CurrentQuantity",name:`ProductionInfo[${o}].CurrentQuantity`,type:"number",fullWidth:!0,variant:"outlined",value:h.CurrentQuantity,onChange:t=>r(`ProductionInfo[${o}].CurrentQuantity`,t.target.value)}),e.jsx(Q,{name:`ProductionInfo[${o}].CurrentQuantity`,component:"div",className:"text-red-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{label:"ProductionAmount",name:`ProductionInfo[${o}].ProductionAmount`,type:"number",fullWidth:!0,variant:"outlined",value:h.ProductionAmount,onChange:t=>{r(`ProductionInfo[${o}].ProductionAmount`,t.target.value);const u=a.ProductionInfo[o].ProductId,g=f.find(v=>v.ItemId===u);r(`ProductionInfo[${o}].CurrentQuantity`,Number(t.target.value)+Number((g==null?void 0:g.Quantity)||0))}}),e.jsx(Q,{name:`ProductionInfo[${o}].ProductionAmount`,component:"div",className:"text-red-500"})]}),a.ProductionInfo.length>1&&e.jsx(y,{type:"button",variant:"outlined",color:"secondary",onClick:()=>p.remove(o),children:"Remove Product"})]})},o)),j.length!=f.length&&e.jsx(y,{type:"button",variant:"outlined",color:"primary",onClick:()=>p.push({ProductId:"",CurrentQuantity:0,ProductionAmount:0}),children:"Add Product"})]})}),e.jsxs(b,{display:"flex",justifyContent:"flex-end",className:"gap-4 mt-4",children:[e.jsx(y,{variant:"outlined",color:"secondary",onClick:()=>c(),children:"Cancel"}),e.jsx(y,{variant:"contained",color:"primary",onClick:()=>A(a),children:"Save"})]})]})}})]})})}const re=[{key:"ProductName",label:"Name"},{key:"MakingPrice",label:"MAKING_COST"},{key:"SellingPrice",label:"SELLING_COST"},{key:"Quantity",label:"QUANTITY"}],k={ItemId:"",ProductName:"",Description:"",MakingPrice:"",SellingPrice:"",Quantity:""};function de(){var M,T;const{data:i,isLoading:c,refetch:n}=U({pageNumber:1,pageSize:10,itemId:""}),[l,{isLoading:C}]=H(),[I,{isLoading:m}]=J(),[f,{isLoading:A}]=X(),[a,r]=x.useState(!1),[P,N]=x.useState(!1),[j,p]=x.useState(!1),[h,o]=x.useState(!1),[t,u]=x.useState(k),g=s=>{u(S=>({...S,[s.target.name]:s.target.value}))},v=async()=>{h?(await I({payload:{ItemId:t.ItemId,ProductName:t.ProductName,Description:t.Description,MakingPrice:Number(t.MakingPrice),SellingPrice:Number(t.SellingPrice),Quantity:Number(t.Quantity)}}).unwrap(),r(!1),o(!1),n()):(await l({payload:{ProductName:t.ProductName,Description:t.Description,MakingPrice:Number(t.MakingPrice),SellingPrice:Number(t.SellingPrice),Quantity:Number(t.Quantity)}}).unwrap(),r(!1),n())},R=()=>{r(!1),o(!1),u(k)},E=async(s,S)=>{u({ItemId:s.ItemId,ProductName:s.ProductName,Description:s.Description,MakingPrice:s.MakingPrice.toString(),SellingPrice:s.SellingPrice.toString(),Quantity:s.Quantity.toString()}),S?p(!0):(o(!0),r(!0))},_=async s=>{p(!1),s&&(await f({id:t.ItemId}).unwrap(),n())},W=()=>{u(k),r(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full",children:[e.jsx(D,{onClick:()=>W(),className:"fixed bottom-4 right-4 ml-4 my-3 cursor-pointer",text:"ADD_PRODUCT",variant:"primary"}),e.jsx(D,{onClick:()=>N(!0),className:"fixed bottom-4 right-36 ml-4 my-3 cursor-pointer",text:"ADD_PRODUCTION",variant:"primary"}),i&&i&&((M=i==null?void 0:i.Data)==null?void 0:M.length)>0&&e.jsx("div",{className:"p-10 w-full",children:e.jsx(Z,{showActionButtons:!0,handleRowClick:E,columns:re,data:(i==null?void 0:i.Data)||[],rowsPerPage:10})}),!c&&i&&i&&((T=i==null?void 0:i.Data)==null?void 0:T.length)==0&&e.jsx("div",{className:"p-10 w-full",children:"No data found"}),c&&e.jsx("div",{className:"p-10 w-full",children:"Loading..."})]}),a&&e.jsx(te,{isUpdate:h,handleSubmit:v,formData:t,isOpen:a,handleFormData:g,handleCancel:R}),P&&e.jsx(ie,{isOpen:P,handleClose:()=>{N(!1),n()}}),j&&e.jsx(V,{handleConfirm:_,isOpen:!0})]})}export{de as default};
