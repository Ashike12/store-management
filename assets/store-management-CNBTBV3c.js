import{j as e,M as U,B as Q,T as E,k as m,l as J,m as O,n as X,o as R,p as Z,q as _,t as V,r as u,F as ee,v as te,w as ne,E as w,x as re,y as oe,z as ie,C as $}from"./index-Bilkcy3_.js";import{C as ae}from"./CustomTable-PaS8ooqf.js";import{B as b}from"./Button-CO-uh0HS.js";import{D as se}from"./delete-confirmation.modal-DPJdXp4F.js";import{M as ue}from"./MenuItem-BOpo2A8T.js";function ce({isOpen:v,handleCancel:P,formData:t,handleFormData:c,handleSubmit:l,isUpdate:I}){const p=J;return e.jsx(U,{open:v,onClose:()=>P(),children:e.jsxs(Q,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:5,borderRadius:2},children:[e.jsx(E,{variant:"H5",content:I?"UPDATE_PRODUCT":"ADD_PRODUCT"}),e.jsxs(Q,{display:"flex",flexDirection:"column",className:"gap-5 mt-4",children:[e.jsx(m,{className:"w-full",label:p({content:"PRODUCT_NAME"}),name:"ProductName",value:t==null?void 0:t.ProductName,onChange:c,fullWidth:!0}),e.jsx(m,{label:p({content:"PRODUCT_DESCRIPTION"}),name:"Description",value:t==null?void 0:t.Description,onChange:c,fullWidth:!0,rows:2}),e.jsx(m,{label:p({content:"MAKING_COST"}),name:"MakingPrice",type:"number",value:t==null?void 0:t.MakingPrice,onChange:c,fullWidth:!0}),e.jsx(m,{label:p({content:"SELLING_COST"}),name:"SellingPrice",type:"number",value:t==null?void 0:t.SellingPrice,onChange:c,fullWidth:!0}),e.jsx(m,{label:p({content:"QUANTITY"}),name:"Quantity",type:"number",value:t==null?void 0:t.Quantity,onChange:c,fullWidth:!0})]}),e.jsxs(Q,{display:"flex",justifyContent:"flex-end",className:"gap-4 mt-4",children:[e.jsx(b,{variant:"outlined",color:"secondary",onClick:()=>P(),children:"Cancel"}),e.jsx(b,{variant:"contained",color:"primary",onClick:()=>l(),children:I?"Update":"Save"})]})]})})}const le=O({ProductionInfo:X().of(O({ProductId:Z().required("Product ID is required"),CurrentQuantity:R().required("CurrentQuantity is required").positive("CurrentQuantity must be positive").integer("CurrentQuantity must be an integer"),ProductionAmount:R().required("ProductionAmount is required").positive("ProductionAmount must be positive").integer("ProductionAmount must be an integer")})).min(1,"At least one product is required")}),de={ProductionInfo:[{ProductId:"",CurrentQuantity:0,ProductionAmount:0}]};function me({isOpen:v,handleClose:P}){const{data:t,isLoading:c,refetch:l}=_({pageNumber:1,pageSize:1e3,itemId:""}),[I,{isLoading:p}]=V(),f=(t==null?void 0:t.Data)||[],A=async a=>{let s={ProductionInfo:[]};a.ProductionInfo.forEach(g=>{g.ProductId!==""&&s.ProductionInfo.push({ProductId:g.ProductId,Quantity:g.CurrentQuantity})}),console.log("Payload",s),await I({payload:s}).unwrap(),P()};return u.useEffect(()=>{l()},[l]),e.jsx(U,{open:v,onClose:()=>P(),children:e.jsxs(Q,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"50%",bgcolor:"background.paper",boxShadow:24,p:5,borderRadius:2},children:[e.jsx(E,{variant:"H5",content:"ADD_PRODUCTION"}),e.jsx(ee,{initialValues:de,validationSchema:le,onSubmit:a=>{console.log("Form data",a)},children:({values:a,setFieldValue:s,errors:g,touched:y})=>{const N=a.ProductionInfo.map(h=>h.ProductId);return e.jsxs(te,{children:[e.jsx(ne,{name:"ProductionInfo",render:h=>e.jsxs("div",{children:[a.ProductionInfo.map((j,o)=>e.jsx("div",{className:"my-4",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(m,{label:"Product ID",name:`ProductionInfo[${o}].ProductId`,fullWidth:!0,variant:"outlined",select:!0,value:j.ProductId,onChange:i=>{s(`ProductionInfo[${o}].ProductId`,i.target.value);const d=f.find(r=>r.ItemId===i.target.value);s(`ProductionInfo[${o}].CurrentQuantity`,(d==null?void 0:d.Quantity)||0)},children:f.map(i=>e.jsx(ue,{disabled:N.indexOf(i.ItemId)>-1,value:i.ItemId,children:i.ProductName},i.ItemId))}),e.jsx(w,{name:`ProductionInfo[${o}].ProductId`,component:"div",className:"text-red-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(m,{disabled:!0,label:"CurrentQuantity",name:`ProductionInfo[${o}].CurrentQuantity`,type:"number",fullWidth:!0,variant:"outlined",value:j.CurrentQuantity,onChange:i=>s(`ProductionInfo[${o}].CurrentQuantity`,i.target.value)}),e.jsx(w,{name:`ProductionInfo[${o}].CurrentQuantity`,component:"div",className:"text-red-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(m,{label:"ProductionAmount",name:`ProductionInfo[${o}].ProductionAmount`,type:"number",fullWidth:!0,variant:"outlined",value:j.ProductionAmount,onChange:i=>{s(`ProductionInfo[${o}].ProductionAmount`,i.target.value);const d=a.ProductionInfo[o].ProductId,r=f.find(C=>C.ItemId===d);s(`ProductionInfo[${o}].CurrentQuantity`,Number(i.target.value)+Number((r==null?void 0:r.Quantity)||0))}}),e.jsx(w,{name:`ProductionInfo[${o}].ProductionAmount`,component:"div",className:"text-red-500"})]}),a.ProductionInfo.length>1&&e.jsx(b,{type:"button",variant:"outlined",color:"secondary",onClick:()=>h.remove(o),children:"Remove Product"})]})},o)),N.length!=f.length&&e.jsx(b,{type:"button",variant:"outlined",color:"primary",onClick:()=>h.push({ProductId:"",CurrentQuantity:0,ProductionAmount:0}),children:"Add Product"})]})}),e.jsxs(Q,{display:"flex",justifyContent:"flex-end",className:"gap-4 mt-4",children:[e.jsx(b,{variant:"outlined",color:"secondary",onClick:()=>P(),children:"Cancel"}),e.jsx(b,{variant:"contained",color:"primary",onClick:()=>A(a),children:"Save"})]})]})}})]})})}const Pe=[{key:"ProductName",label:"Name"},{key:"MakingPrice",label:"MAKING_COST"},{key:"SellingPrice",label:"SELLING_COST"},{key:"Quantity",label:"QUANTITY"}],k={ItemId:"",ProductName:"",Description:"",MakingPrice:"",SellingPrice:"",Quantity:""};function fe(){var D,L;const[v,P]=u.useState({pageNumber:1,pageSize:1e3,itemId:""}),{data:t,isLoading:c,refetch:l}=_(v),[I,{isLoading:p}]=re(),[f,{isLoading:A}]=oe(),[a,{isLoading:s}]=ie(),[g,y]=u.useState(!1),[N,h]=u.useState(!1),[j,o]=u.useState(!1),[i,d]=u.useState(!1),[r,C]=u.useState(k),[M,W]=u.useState(""),[x,T]=u.useState([0,1e5]),q=n=>{C(S=>({...S,[n.target.name]:n.target.value}))},B=async()=>{i?(await f({payload:{ItemId:r.ItemId,ProductName:r.ProductName,Description:r.Description,MakingPrice:Number(r.MakingPrice),SellingPrice:Number(r.SellingPrice),Quantity:Number(r.Quantity)}}).unwrap(),y(!1),d(!1),l()):(await I({payload:{ProductName:r.ProductName,Description:r.Description,MakingPrice:Number(r.MakingPrice),SellingPrice:Number(r.SellingPrice),Quantity:Number(r.Quantity)}}).unwrap(),y(!1),l())},G=()=>{y(!1),d(!1),C(k)},z=async(n,S)=>{C({ItemId:n.ItemId,ProductName:n.ProductName,Description:n.Description,MakingPrice:n.MakingPrice.toString(),SellingPrice:n.SellingPrice.toString(),Quantity:n.Quantity.toString()}),S?o(!0):(d(!0),y(!0))},F=async n=>{o(!1),n&&(await a({id:r.ItemId}).unwrap(),l())},K=()=>{C(k),y(!0)},Y=u.useMemo(()=>t!=null&&t.Data?t.Data.filter(n=>{const S=n.ProductName.toLowerCase().includes(M.toLowerCase())||n.Description.toLowerCase().includes(M.toLowerCase()),H=n.SellingPrice>=x[0]&&n.SellingPrice<=x[1];return S&&H}):[],[t,M,x]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full",children:[e.jsx($,{onClick:()=>K(),className:"fixed bottom-4 right-4 ml-4 my-3 cursor-pointer",text:"ADD_PRODUCT",variant:"primary"}),e.jsx($,{onClick:()=>h(!0),className:"fixed bottom-4 right-36 ml-4 my-3 cursor-pointer",text:"ADD_PRODUCTION",variant:"primary"}),t&&t&&((D=t==null?void 0:t.Data)==null?void 0:D.length)>0&&e.jsxs("div",{className:"p-10 w-full",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("input",{type:"text",placeholder:"Search by name or description",className:"border p-2 rounded w-full sm:w-1/2",value:M,onChange:n=>W(n.target.value)}),e.jsxs("div",{className:"flex gap-2 items-center w-full sm:w-1/2",children:[e.jsx("input",{type:"number",className:"border p-2 rounded w-1/2",placeholder:"Min Price",value:x[0],onChange:n=>T([+n.target.value,x[1]])}),e.jsx("input",{type:"number",className:"border p-2 rounded w-1/2",placeholder:"Max Price",value:x[1],onChange:n=>T([x[0],+n.target.value])})]})]}),e.jsx(ae,{showActionButtons:!0,handleRowClick:z,columns:Pe,data:Y||[],rowsPerPage:10})]}),!c&&t&&t&&((L=t==null?void 0:t.Data)==null?void 0:L.length)==0&&e.jsx("div",{className:"p-10 w-full",children:"No data found"}),c&&e.jsx("div",{className:"p-10 w-full",children:"Loading..."})]}),g&&e.jsx(ce,{isUpdate:i,handleSubmit:B,formData:r,isOpen:g,handleFormData:q,handleCancel:G}),N&&e.jsx(me,{isOpen:N,handleClose:()=>{h(!1),l()}}),j&&e.jsx(se,{handleConfirm:F,isOpen:!0})]})}export{fe as default};
