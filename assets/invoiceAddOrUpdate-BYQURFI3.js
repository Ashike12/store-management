import{b as V,a as G,r as P,u as z,L as U,D as H,E as _,j as t,s as J,c as k,d as K,F as X,G as Y,H as Z,J as S,K as T,N as D,O as R,Q as ee,S as w,U as L,w as te,z as ae,A as se,l as ne,p as oe,y as ie,V as re,W as le,X as de,C as ce,Y as ue,Z as me,_ as pe,$ as ge,a0 as ve,a1 as Ie,a2 as y,a3 as ye,i as h,T as B}from"./index-6Mo_YPcM.js";import{B as M}from"./Button-BaW1ZP3C.js";const q=V("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);function fe(e){return G("MuiMenuItem",e)}const f=V("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),xe=(e,a)=>{const{ownerState:n}=e;return[a.root,n.dense&&a.dense,n.divider&&a.divider,!n.disableGutters&&a.gutters]},be=e=>{const{disabled:a,dense:n,divider:r,disableGutters:m,selected:p,classes:u}=e,l=K({root:["root",n&&"dense",a&&"disabled",!m&&"gutters",r&&"divider",p&&"selected"]},fe,u);return{...u,...l}},Pe=J(X,{shouldForwardProp:e=>Y(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:xe})(Z(({theme:e})=>({...e.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${f.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:S(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${f.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:S(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${f.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:S(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:S(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${f.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${f.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${q.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${q.inset}`]:{marginLeft:52},[`& .${D.root}`]:{marginTop:0,marginBottom:0},[`& .${D.inset}`]:{paddingLeft:36},[`& .${T.root}`]:{minWidth:36},variants:[{props:({ownerState:a})=>!a.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:a})=>a.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:a})=>!a.dense,style:{[e.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:a})=>a.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...e.typography.body2,[`& .${T.root} svg`]:{fontSize:"1.25rem"}}}]}))),F=P.forwardRef(function(a,n){const r=z({props:a,name:"MuiMenuItem"}),{autoFocus:m=!1,component:p="li",dense:u=!1,divider:x=!1,disableGutters:l=!1,focusVisibleClassName:Q,role:j="menuitem",tabIndex:C,className:$,...O}=r,g=P.useContext(U),b=P.useMemo(()=>({dense:u||g.dense||!1,disableGutters:l}),[g.dense,u,l]),v=P.useRef(null);H(()=>{m&&v.current&&v.current.focus()},[m]);const N={...r,dense:b.dense,divider:x,disableGutters:l},s=be(r),d=_(v,n);let A;return r.disabled||(A=C!==void 0?C:-1),t.jsx(U.Provider,{value:b,children:t.jsx(Pe,{ref:d,role:j,tabIndex:A,component:p,focusVisibleClassName:k(s.focusVisible,Q),className:k(s.root,$),...O,ownerState:N,classes:s})})}),Se=R({WholeSalerId:w(),PaymentAmount:L().required("Payment Amount is required").positive("Amount must be positive"),ProductSellInfo:ee().of(R({ProductId:w().required("Product ID is required"),SellingPrice:L().required("Selling Price is required").positive("Selling Price must be positive"),Quantity:L().required("Quantity is required").positive("Quantity must be positive").integer("Quantity must be an integer"),SellingDate:w().required("Selling Date is required")})).min(1,"At least one product is required")}),he={PaymentAmount:0,ProductSellInfo:[{ItemId:"",ProductId:"",Quantity:0,SellingPrice:0,SellingDate:""}],WholeSalerId:""},je=e=>{const a=e.ProductSellInfo.map(n=>({ItemId:n.ItemId,ProductId:n.ProductId,Quantity:n.Quantity,SellingPrice:n.SellingPrice,SellingDate:n.SellingDate}));return{PaymentAmount:e.PaymentAmount,ProductSellInfo:a,WholeSalerId:e.WholeSalerId}};function we(){const e=te(),{id:a}=ae(),[n]=se(),r=n.get("isUpdate")==="true",{data:m,isLoading:p}=ne({pageNumber:1,pageSize:1e3,itemId:""}),{data:u,isLoading:x}=oe({pageNumber:1,pageSize:10,itemId:""}),{data:l,isLoading:Q}=ie({pageNumber:1,pageSize:10,itemId:a??""}),[j,{isLoading:C}]=re(),[$,{isLoading:O}]=le(),g=(m==null?void 0:m.Data)||[],b=(u==null?void 0:u.Data)||[];if(p||x)return t.jsx(de,{});console.log(l);const v=s=>{e(`/invoice/${s}/${a}`)},N=async s=>{if(console.log("Form data",s),r){const d=s;d.ItemId=a??"",console.log("Update payload",d),await $({payload:d}).unwrap()}else await j({payload:s}).unwrap();e("/invoice")};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"w-full",children:[t.jsx(ce,{onClick:()=>v("details"),className:"fixed bottom-4 right-4 ml-4 my-3 cursor-pointer",text:"DETAILS_INVOICE",variant:"primary"}),t.jsxs("div",{className:"max-w-3xl mx-auto p-6 bg-white shadow-lg rounded-xl mt-10",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800 border-b pb-3",children:r?"Invoice Update":"Invoice Add"}),t.jsx("div",{className:"mt-4 space-y-2",children:t.jsx(ue,{initialValues:r?je(l==null?void 0:l.Data):he,validationSchema:Se,onSubmit:s=>{console.log("Form data",s)},children:({values:s,setFieldValue:d,errors:A,touched:Ce})=>{const W=s.ProductSellInfo.map(i=>i.ProductId),E=s.ProductSellInfo.reduce((I,o)=>I+o.SellingPrice*o.Quantity,0);return t.jsxs(me,{children:[t.jsx("div",{className:"mb-4",children:t.jsxs(pe,{fullWidth:!0,children:[t.jsx(ge,{children:"Wholesaler"}),t.jsx(ve,{as:Ie,name:"WholeSalerId",label:"Wholesaler",children:b.map(i=>t.jsx(F,{value:i.ItemId,children:i.DisplayName},i.ItemId))}),t.jsx(y,{name:"WholeSalerId",component:"div",className:"text-red-500"})]})}),t.jsx(ye,{name:"ProductSellInfo",render:i=>t.jsxs("div",{children:[s.ProductSellInfo.map((I,o)=>t.jsx("div",{className:"mb-4",children:t.jsxs("div",{className:"flex space-x-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx(h,{label:"Product ID",name:`ProductSellInfo[${o}].ProductId`,fullWidth:!0,variant:"outlined",select:!0,value:I.ProductId,onChange:c=>d(`ProductSellInfo[${o}].ProductId`,c.target.value),children:g.map(c=>t.jsx(F,{disabled:W.indexOf(c.ItemId)>-1,value:c.ItemId,children:c.ProductName},c.ItemId))}),t.jsx(y,{name:`ProductSellInfo[${o}].ProductId`,component:"div",className:"text-red-500"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx(h,{label:"Selling Price",name:`ProductSellInfo[${o}].SellingPrice`,type:"number",fullWidth:!0,variant:"outlined",value:I.SellingPrice,onChange:c=>d(`ProductSellInfo[${o}].SellingPrice`,c.target.value)}),t.jsx(y,{name:`ProductSellInfo[${o}].SellingPrice`,component:"div",className:"text-red-500"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx(h,{label:"Quantity",name:`ProductSellInfo[${o}].Quantity`,type:"number",fullWidth:!0,variant:"outlined",value:I.Quantity,onChange:c=>d(`ProductSellInfo[${o}].Quantity`,c.target.value)}),t.jsx(y,{name:`ProductSellInfo[${o}].Quantity`,component:"div",className:"text-red-500"})]}),s.ProductSellInfo.length>1&&t.jsx(M,{type:"button",variant:"outlined",color:"secondary",onClick:()=>i.remove(o),children:"Remove Product"})]})},o)),W.length!=g.length&&t.jsx(M,{type:"button",variant:"outlined",color:"primary",onClick:()=>i.push({ProductId:"",Quantity:0,SellingPrice:0,SellingDate:""}),children:"Add Product"})]})}),t.jsxs("div",{className:"flex flex-row gap-4 mt-6",children:[t.jsxs("div",{className:"mb-4 basis-1/2",children:[t.jsx(h,{label:"Payment Amount",name:"PaymentAmount",type:"number",fullWidth:!0,variant:"outlined",value:s.PaymentAmount,onChange:i=>d("PaymentAmount",i.target.value)}),t.jsx(y,{name:"PaymentAmount",component:"div",className:"text-red-500"})]}),t.jsxs("div",{className:"basis-1/2 border flex items-center border-transparent-grey-24 rounded-md px-4 mb-4",children:[t.jsx(B,{variant:"Body1",content:"TOTAL_AMOUNT"}),":",t.jsx(B,{variant:"Subtitle1Bold",content:E})]})]}),t.jsx("div",{className:"mt-4",children:t.jsx(M,{onClick:()=>N(s),disabled:!s.ProductSellInfo.length||!s.PaymentAmount,type:"submit",variant:"contained",color:"primary",children:"Submit Invoice"})})]})}})})]})]})})}export{we as default};
